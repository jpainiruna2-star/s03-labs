Práctica 1
#Server 1
sudo mkdir ~/arch
cd arch
sudo touch arch{1..100}.txt
ls
cd
rsync ~/arch/* efeliz@10.0.0.87:~/Documentos
vim sinc.sh
#!/bin/bash
rsync -a ~/arch/* efeliz@10.0.0.87:/home/efeliz/Documentos
cd arch
touch prub.txt
cd
chmod +x sinc.sh
crontab -e
* * * * * /home/efeliz/sinc.sh
crontab -l

#Server 2
cd Documentos
ls
ls prub.txt

Práctica 2
#Server 1 y 2
sudo dnf repolist --all
sudo dnf config-manager --enable ol10_addons
ip a
sudo nano /etc/hosts
sudo dnf install pcs pacemaker corosync -y
sudo systemctl enable pcsd
sudo systemctl start pcsd
sudo passwd hacluster

#Desde un solo server
sudo pcs host auth mamalona node-b clone
hacluster
sudo pcs cluster setup config evildead node-b clone --force
sudo pcs cluster enable --all
sudo pcs cluster start --all
sudo pcs status
sudo pcs resource create VIP ocf:heartbeat:IPaddr2 ip=10.0.0.50 op monitor interval=5s
sudo pcs property set stonith-enabled=false
sudo pcs status
ping 10.0.0.50
nmcli con down ens18
sudo pcs status

Práctica 3
sudo -i
dnf install keepalived -y
nano /etc/keepalived/keepalived.conf
global_defs {
    router_id SERVER1
}

vrrp_script check_service {
    script "/usr/bin/killall -0 nginx"  # Cambia según tu servicio
    interval 2
    weight 2
}

vrrp_instance VI_1 {
    state MASTER          # EN BACKUP CAMBIAR MASTER POR BACKUP 
    interface ens160
    virtual_router_id 51
    priority 100           # EN BACKUP LA PRIORIDAD DEBE SER MASBAJA
    advert_int 1

    authentication {
        auth_type PASS
        auth_pass 1234
    }

    virtual_ipaddress {
        10.0.0.200/24
    }

    track_script {
        check_service
    }
}

nano /var/www/html/index.html
<h1>Hola mundo desde server 1!</h1>
firewall-cmd --zone=public --add-protocol=vrrp --permanent
firewall-cmd --reload
systemctl enable keepalived
systemctl start keepalived
ip a
ping 10.0.0.200
nmcli con down ens160

nmcli con up ens160
